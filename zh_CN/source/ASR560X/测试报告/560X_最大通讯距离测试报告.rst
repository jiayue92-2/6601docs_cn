ASR560X 系列最大通讯距离测试报告
===============================

前言
----

**关于本文档**

本文档旨在提供使用 ASR560X EVB 进行最大通讯距离测试的方案、过程和结果。

**读者对象**

本文档主要适用于以下工程师：

-  单板硬件开发工程师
-  软件工程师
-  技术支持工程师

**产品型号**

本文档适用于 ASR560X 系列蓝牙芯片。

+---------+-------------------------------------------------------------------------------------------+----------+--------------+------------------------------------------------------------------------------------+
| Model   | Protocol                                                                                  | Core     | SiP Flash    | Function                                                                           |
+=========+===========================================================================================+==========+==============+====================================================================================+
| ASR560X | BLE 5.1 full feature (compatible with 5.2) SIG MESH V1.0.x IEEE 802.15.4 2.4G Proprietary | ARM CM0+ | 1 MB/ 512 KB | AOA/AOD/Voice/IRTxRx/ Quadrature Decoder/Keypad/ 5V UART/5V GPIO/ Wi-Fi concurrent |
+---------+-------------------------------------------------------------------------------------------+----------+--------------+------------------------------------------------------------------------------------+

**版权公告**

版权归 © 2022 翱捷科技股份有限公司所有。保留一切权利。未经翱捷科技股份有限公司的书面许可，不得以任何形式或手段复制、传播、转录、存储或翻译本文档的部分或所有内容。

**商标声明**

ASR、翱捷和其他翱捷商标均为翱捷科技股份有限公司的商标。

本文档提及的其他所有商标名称、商标和注册商标均属其各自所有人的财产，特此声明。

**免责声明**

翱捷科技股份有限公司对本文档内容不做任何形式的保证，并会对本文档内容或本文中介绍的产品进行不定期更新。

本文档仅作为使用指导，本文的所有内容不构成任何形式的担保。本文档中的信息如有变更，恕不另行通知。

本文档不负任何责任，包括使用本文档中的信息所产生的侵犯任何专有权行为的责任。

**防静电警告**

静电放电（ESD）可能会损坏本产品。使用本产品进行操作时，须小心进行静电防护，避免静电损坏产品。

**翱捷科技股份有限公司**

地址：上海市浦东新区科苑路 399 号张江创新园 10 号楼 9 楼 邮编：201203

官网： http://www.asrmicro.com/

**文档修订历史**

======= ====== ===========
日期    版本号 发布说明
======= ====== ===========
2022.12 V1.0.0 修改表3-1。
======= ====== ===========

1. 测试准备
-----------

1.1 硬件
~~~~~~~~

-  两块 ASR560X EVB
-  若干根 USB 转 UART 串口线
-  两台笔记本电脑
-  一部手机

1.2 软件
~~~~~~~~

-  使用串口调试助手 SCCOM 5.13.1

-  测试所用软件及其版本：

   -  **Central Device**\ ：

      Bootloader 名称：bootloader.bin

      ROM：sonata_hl_ll_rom.bin

      Bin 名称：sonata_hl_perf_test_central_rel.bin

   -  **Peripheral Device**\ ：

      Bootloader 名称：bootloader.bin

      ROM：sonata_hl_ll_rom.bin

      Bin 名称：sonata_hl_perf_test_peripheral_rel.bin

   -  版本号为 SDK V1.2.0，编译日期为 2021-03-24

1.3 测试地点
~~~~~~~~~~~~

因为上海浦东新区世纪公园，环境空旷，空口情况相对干净，所以选择此处作为测试地点。世纪公园的卫星地图如下所示：

|image1| 

2.测试方法
----------

2.1 准备工作
~~~~~~~~~~~~

通过配置不同的调制速率和发射功率来测试 ASR560X 芯片最大的通讯距离。

1. 测试用到两个工程：

   (1) sonata_hl_perf_test_central_rel，后面简称为 central。

   (2) sonata_hl_perf_test_peripheral_rel，后面简称为 peripheral。

2. 测试前将 app.h 中的宏 THROUGHPUT_TEST 设为 0。

3. Peripheral 工程的代码支持 1 Mbps、2 Mbps、500 Kbps 和 125 Kbps 下的拉距测试。通过 AT 命令\ *set_perf_rate x*\ 设置速率，x 取值 0、1、2、3，对应 1 Mbps、2 Mbps、125 Kbps、500 Kbps，默认值为 1 Mbps。设置速率后，需要重启 DUT。设置示例如下图：

|image2| 

4. Peripheral 工程支持发射功率设置，默认发射功率为 0 dBm，按下 SW3 按键设置发射功率为 4 dBm，按下 SW4 按键设置发射功率 10 dBm，接线方式参见下图：

|image3| 

5. 版本烧录：

   (1) 用 A 板和 B 板来指代两块开发板，这两块开发板都需要烧录 bootloader 以及 ROM。

   (2) A 板下载 peripheral 工程 bin 文件，然后通过命令\ *set_bt_address 111100001111*\ 设置蓝牙地址。

   (3) A 板 GPIO10 连接 LED，GPIO2 连接 SW3，GPIO3 连接 SW4。

   (4) B 板下载 central 工程 bin 文件。

   (5) B 板 GPIO10 连接 LED。

2.2 测试步骤
~~~~~~~~~~~~

1. 先上电 A 板，按照准备工作中介绍的命令设置 PHY 速率（默认为 1 Mbps，设置速率后需要重启单板）。

2. 按照表 3-1 中的测试条件，设置发射功率（默认为 0 dBm）。

3. B 板上电，A、B 板开始建立连接，连接建立后，A、B 板 LED 灯常亮。

4. A、B 板逐渐拉远距离，直到两个 DUT 断开连接（即 LED 灯熄灭）。

5. 使用光学测距仪测量 A、B 间的距离。

6. 增大发射功率（0 dBm→4 dBm→10 dBm），重复步骤 3~步骤 5。

2.3 注意事项
~~~~~~~~~~~~

1. 测试场地尽量空旷，无过多蓝牙设备干扰。

2. DUT 在视距之内，两板之间无遮挡。

3. 使用笔记本提供稳定的电源。

4. 增加测试次数，减少误差。

3.测试结果
----------

|image4| 

|image5| 

4.最大通讯距离测试的相关资料
----------------------------

理论最大通讯距离的参考信息如下：

https://www.bluetooth.com/learn-about-bluetooth/key-attributes/range/#estimator

.. |image1| image:: ../../img/560X_最大通讯距离测试报告/图1-1.png
.. |image2| image:: ../../img/560X_最大通讯距离测试报告/图2-1.png
.. |image3| image:: ../../img/560X_最大通讯距离测试报告/图2-2.png
.. |image4| image:: ../../img/560X_最大通讯距离测试报告/表3-1.png
.. |image5| image:: ../../img/560X_最大通讯距离测试报告/图3-1.png
