.. role:: raw-latex(raw)
   :format: latex
..

ASR6601 Bootloader 通信说明
===========================
`English <https://asriot.readthedocs.io/en/latest/ASR6601/Quick-Start/communication_notes.html>`_


前言
----

**关于本文档**

本文档主要对 ASR6601 中内部 Bootloader 的通信协议进行说明。

**读者对象**

本文档主要适用于以下工程师：

-  软件工程师
-  技术支持工程师

**产品型号**

与本文档相对应的产品型号如下：

+------------+-----------+----------+--------------------------------------------+---------------+---------------+
| **型号**   | **Flash** | **SRAM** | **内核**                                   | **封装**      | **频率**      |
+============+===========+==========+============================================+===============+===============+
| ASR6601SE  | 256 KB    | 64 KB    | 32-bit 48 MHz Arm China STAR-MC1 Processor | QFN68, 8*8 mm | 150 ~ 960 MHz |
+------------+-----------+----------+--------------------------------------------+---------------+---------------+
| ASR6601CB  | 128 KB    | 16 KB    | 32-bit 48 MHz Arm China STAR-MC1 Processor | QFN48, 6*6 mm | 150 ~ 960 MHz |
+------------+-----------+----------+--------------------------------------------+---------------+---------------+
| ASR6601SER | 256 KB    | 64 KB    | 32-bit 48 MHz Arm China STAR-MC1 Processor | QFN68, 8*8 mm | 150 ~ 960 MHz |
+------------+-----------+----------+--------------------------------------------+---------------+---------------+
| ASR6601CBR | 128 KB    | 16 KB    | 32-bit 48 MHz Arm China STAR-MC1 Processor | QFN48, 6*6 mm | 150 ~ 960 MHz |
+------------+-----------+----------+--------------------------------------------+---------------+---------------+

**版权公告**

版权归 © 2023 翱捷科技股份有限公司所有。保留一切权利。未经翱捷科技股份有限公司的书面许可，不得以任何形式或手段复制、传播、转录、存储或翻译本文档的部分或所有内容。

**商标声明**

ASR、翱捷和其他翱捷商标均为翱捷科技股份有限公司的商标。

本文档提及的其他所有商标名称、商标和注册商标均属其各自所有人的财产，特此声明。

**免责声明**

翱捷科技股份有限公司对本文档内容不做任何形式的保证，并会对本文档内容或本文中介绍的产品进行不定期更新。

本文档仅作为使用指导，本文的所有内容不构成任何形式的担保。本文档中的信息如有变更，恕不另行通知。

本文档不负任何责任，包括使用本文档中的信息所产生的侵犯任何专有权行为的责任。

**防静电警告**

静电放电（ESD）可能会损坏本产品。使用本产品进行操作时，须小心进行静电防护，避免静电损坏产品。

**翱捷科技股份有限公司**

地址：上海市浦东新区科苑路399号张江创新园10号楼9楼 邮编：201203

官网： http://www.asrmicro.com/

**文档修订历史**

======= ====== ==========
日期    版本号 发布说明
======= ====== ==========
2023.01 V0.1.0 首次发布。
======= ====== ==========

1. BootLoader命令说明
---------------------

1.1 串口设置
~~~~~~~~~~~~

Baud rate: 921600

Data bits: 8

Stop bits: 1

Parity: None

Flow Control: None

1.2 命令一览
~~~~~~~~~~~~

======== ============ ==========================
**命令** **命令编号** **说明**
======== ============ ==========================
SYNC     1            SYNC命令，判断是否连接正常
JUMP     2            跳转命令
FLASH    3            烧录命令
ERASE    4            擦除命令
VERIFY   5            验证命令
WROTP    6            写OTP命令
RDOTP    7            读OTP命令
WROPT0   8            写Option0命令
RDOPT0   9            读Option0命令
WROPT1   10           写Option1命令
RDOPT1   11           读Option1命令
REBOOT   12           重启命令
SN       13           读序列号命令
WRREG    14           写寄存器命令
RDREG    15           读寄存器命令
BAUDRATE 16           设置波特率命令
VERSION  17           读取版本号命令
======== ============ ==========================


1.3 基本通信命令格式
~~~~~~~~~~~~~~~~~~~~

1.3.1 请求
~~~~~~~~~~

|image1|

其中，Command 为命令编号，Checksum 算法为 CRC32。

1.3.2 应答
~~~~~~~~~~

|image2|

其中，Status 为状态码，0 为成功，非 0 值表示失败，Checksum 算法为 CRC32。

1.4 命令负载格式
~~~~~~~~~~~~~~~~

1.4.1 SYNC命令负载格式
^^^^^^^^^^^^^^^^^^^^^^

请求：

无


应答：

无

1.4.2 JUMP命令负载格式
^^^^^^^^^^^^^^^^^^^^^^

请求：

Addr: 4 Bytes，跳转地址


应答：

无

1.4.3 FLASH命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^

请求：

Addr: 4 Bytes，烧录地址

Size: 4 Bytes，烧录数据长度

Data: N Bytes，烧录数据


应答：

无

1.4.4 ERASE命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^

请求：

Addr: 4 Bytes，擦除地址

Size: 4 Bytes，擦除区域大小


应答：

无

1.4.5 VERIFY命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^

请求：

Addr: 4 Bytes，验证起始地址

Size: 4 Bytes，验证区域大小

Checksum: 4 Bytes，验证校验值


应答：

无

1.4.6 WROTP命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^

请求：

Addr: 4 Bytes，烧录地址

Size: 4 Bytes，烧录数据长度

Data: N Bytes，烧录数据


应答：

无

1.4.7 RDOTP命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^

请求：

Addr: 4 Bytes，地址

Size: 4 Bytes，数据长度


应答：

Data: N Bytes，数据

1.4.8 WROPT0命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^

请求：

Opt0_l: 4 Bytes，Option0的低32 bits

Opt0_h: 4 Bytes，Option0的高32 bits


应答：

无

1.4.9 RDOPT0命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^

请求：

无


应答：

Opt0_l: 4 Bytes，Option0的低32 bits

Opt0_h: 4 Bytes，Option0的高32 bits

1.4.10 WROPT1命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^^

请求：

Opt1_l: 4 Bytes，Option1的低32 bits

Opt1_h: 4 Bytes，Option1的高32 bits


应答：

无

1.4.11 RDOPT1命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^^

请求：

无


应答：

Opt1_l: 4 Bytes，Option1的低32 bits

Opt1_h: 4 Bytes，Option1的高32 bits

1.4.12 REBOOT命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^^

请求：

无


应答：

无

1.4.13 SN命令负载格式
^^^^^^^^^^^^^^^^^^^^^

请求：

无


应答：

SN：8 Bytes，序列号

1.4.14 WRREG命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^

请求：

Addr: 4 Bytes，地址

Value: 4 Bytes，值


应答：

无

1.4.15 RDREG命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^

请求：

Addr: 4 Bytes，地址


应答：

Value: 4 Bytes，值

1.4.16 BAUDRATE命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^^^^

请求：

Baudrate: 4 Bytes，波特率


应答：

无

1.4.17 VERSION命令负载格式
^^^^^^^^^^^^^^^^^^^^^^^^^^

请求：

无


应答：

Version: 4 Bytes，版本号

2. 参考程序
-----------

Bootloader 通信程序可以参考 build:raw-latex:`\scripts`:raw-latex:`\tremo`\_loader.py。

.. |image1| image:: ../../img/6601_通信说明/图1-1.png
.. |image2| image:: ../../img/6601_通信说明/图1-2.png
